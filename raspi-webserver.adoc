= Configure a Web Server on a Raspberry Pi with Installed VM
== Part 1: Install Docker on Raspberry Pi 400

=== ‚úÖ Step 1: Update the System
[,bash]
----
sudo apt update && sudo apt upgrade -y
----

=== ‚úÖ Step 2: Install Docker
Use the official convenience script:
[,bash]
----
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
----

=== ‚úÖ Step 3: Add Your User to Docker Group
[,bash]
----
sudo usermod -aG docker $USER
----
*‚ö†Ô∏è Log out and back in* (or reboot) so the group change takes effect.

=== ‚úÖ Step 4: Test Docker
[,bash]
----
docker run hello-world
----
You should see a message confirming Docker is working.

==üß™ Try Running a Container

Here‚Äôs a quick test with NGINX:

[,bash]
----
docker run -d -p 8080:80 nginx
----

Then open your browser and go to:
----
http://<raspberry_pi_ip>:8080
----

You should see the NGINX welcome page.

== üß± Optional: Docker Compose (for Multi-Container Apps)

[,bash]
----
sudo apt install docker-compose
----

Example `docker-compose.yml` for a simple web + database stack:
[,yaml]
----
version: '3'
services:
  web:
    image: nginx
    ports:
      - "8080:80"
  db:
    image: mariadb
    environment:
      MYSQL_ROOT_PASSWORD: example
----

Run it:
[,bash]
----
docker-compose up -d
----

== üß∞ Part 2: Full Virtual Machines on Pi 400 with QEMU + KVM

NOTE: ‚ö†Ô∏è This works best on a **64-bit Raspberry Pi OS** (or Ubuntu Server for Pi). Make sure you‚Äôre not using a 32-bit OS.

=== ‚úÖ Step 1: Check Architecture
[,bash]
----
uname -m
----
If you see `aarch64`, you‚Äôre good. If it says `armv7l`, you're still on 32-bit.

=== ‚öôÔ∏è Step 2: Install QEMU + KVM and Tools

[,bash]
----
sudo apt update && sudo apt upgrade -y
sudo apt install qemu-system qemu-efi libvirt-daemon-system libvirt-clients bridge-utils virt-manager -y
----

=== üß† Step 3: Verify KVM Support

KVM (Kernel Virtual Machine) uses your CPU‚Äôs virtualization features.

[,bash]
----
ls /dev/kvm
----

If this shows `/dev/kvm`, you're good.

Check if KVM module is loaded:
[,bash]
----
lsmod | grep kvm
----

You should see something like `kvm` and `kvm_arm` or `kvm_arm64`.

=== üõ†Ô∏è Step 4: Create a VM (Headless or with GUI)

You can use:

* `virt-install` (CLI, no GUI)
* `virt-manager` (GUI over VNC or SSH X forwarding)

=== Example CLI VM Setup:
[,bash]
----
sudo virt-install \
--name debian-vm \
--memory 2048 \
--vcpus 2 \
--disk size=10 \
--cdrom /path/to/debian.iso \
--os-type linux \
--os-variant debian10 \
--network network=default \
--graphics none
----

NOTE: You can download a lightweight ISO like Debian ARM64 or Alpine Linux for better performance.

=== üñ•Ô∏è (Optional) Use GUI: Virt-Manager

You can run virt-manager over SSH with X11 forwarding (on your main computer):

[,bash]
----
ssh -X pi@raspberrypi.local
virt-manager
----

Or use VNC if you prefer a remote desktop GUI.

=== üßº Clean Up / Manage VMs

List VMs:
[,bash]
----
virsh list --all
----

Start a VM:
[,bash]
----
virsh start debian-vm
----

Shut it down:
[,bash]
----
virsh shutdown debian-vm
----

Delete a VM:
[,bash]
----
virsh undefine debian-vm
----
=== ‚ö° Pro Tip: Use USB SSD for VMs

If you're running multiple VMs or larger systems, microSD will bottleneck. Move VM storage to an external USB 3.0 SSD.
