<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 2.2: Cryptography Fundamentals: Hashing</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #121212;
            --dark-card: #1e1e1e;
            --dark-text: #e0e0e0;
            --dark-text-secondary: #aaaaaa;
            --dark-border: #333333;
            --dark-accent: #5c6bc0;
            --dark-hover: #2d2d2d;
            --dark-code-bg: #2d2d2d;
            --dark-alert-bg: #252525;
        }
        
        body {
            font-family: "Times New Roman", Times, serif;
            line-height: 1.6;
            color: var(--dark-text);
            background-color: var(--dark-bg);
        }
        
        .header-section {
            background-color: #1a1a1a;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        .code-block {
            background-color: var(--dark-code-bg);
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            color: #a9b7c6;
        }
        
        .task-section {
            margin-bottom: 30px;
        }
        
        .card {
            background-color: var(--dark-card);
            border-color: var(--dark-border);
            color: var(--dark-text);
        }
        
        .card-header.bg-primary {
            background-color: #3949ab !important;
        }
        
        .card-header.bg-secondary {
            background-color: #455a64 !important;
        }
        
        .card-header.bg-info {
            background-color: #0288d1 !important;
        }
        
        .list-group-item {
            background-color: var(--dark-card);
            color: var(--dark-text);
            border-color: var(--dark-border);
        }
        
        .list-group-item-action:hover {
            background-color: var(--dark-hover);
            color: var(--dark-text);
        }
        
        .alert-secondary {
            background-color: var(--dark-alert-bg);
            color: var(--dark-text);
            border-color: var(--dark-border);
        }
        
        .btn-outline-primary {
            color: var(--dark-accent);
            border-color: var(--dark-accent);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--dark-accent);
            color: var(--dark-text);
            border-color: var(--dark-accent);
        }
        
        a {
            color: var(--dark-accent);
        }
        
        a:hover {
            color: #7986cb;
        }
        
        .border-top {
            border-color: var(--dark-border) !important;
        }
        
        .text-muted {
            color: var(--dark-text-secondary) !important;
        }
        
        code {
            color: #bb86fc;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="mb-4">
            <h1 class="display-4">Lab 2.2: Cryptography Fundamentals: Hashing</h1>
            <p class="lead">Understanding hash functions and their applications in data integrity and security</p>
            <hr style="border-color: var(--dark-border);">
        </header>

        <div class="row">
            <div class="col-md-8">
                <!-- Introduction -->
                <section class="mb-4">
                    <p>This lab explores cryptographic hash functions, one-way mathematical algorithms that generate fixed-size outputs from variable-sized inputs. By the end of this lab, you will understand hash function properties, common algorithms, and their applications in data integrity verification and password storage.</p>
                </section>

                <!-- Objectives -->
                <section class="mb-4">
                    <h2>Objectives</h2>
                    <div class="card">
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">Understand the fundamental properties of cryptographic hash functions</li>
                                <li class="list-group-item">Implement and compare different hashing algorithms (MD5, SHA-1, SHA-256, SHA-3)</li>
                                <li class="list-group-item">Explore hash function applications in data integrity verification</li>
                                <li class="list-group-item">Learn best practices for secure password storage using hash functions</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Prerequisites -->
                <section class="mb-4">
                    <h2>Prerequisites</h2>
                    <div class="card">
                        <div class="card-body">
                            <ul>
                                <li>Basic understanding of cryptography concepts</li>
                                <li>Familiarity with a programming language (Python recommended)</li>
                                <li>Basic command-line knowledge</li>
                                <li>Understanding of Lab 2.1 (Brute Force)</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Lab Tasks -->
                <section>
                    <h2 class="mb-3">Lab Tasks</h2>

                    <!-- Task 1 -->
                    <div class="task-section">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h3 class="mb-0">Task 1: Understanding Hash Function Properties</h3>
                            </div>
                            <div class="card-body">
                                <p>Explore the fundamental properties of cryptographic hash functions through practical examples.</p>
                                <ol>
                                    <li>Create a simple Python script to generate hashes for various inputs</li>
                                    <li>Demonstrate the avalanche effect by comparing hashes of similar inputs</li>
                                    <li>Verify the fixed output length property across different input sizes</li>
                                    <li>Test the one-way property by attempting to derive inputs from hash values</li>
                                </ol>
                                <div class="alert alert-secondary">
                                    <strong>Example Python Code:</strong>
                                    <pre>
import hashlib

def demonstrate_hash_properties(input_text):
    # Generate SHA-256 hash
    hash_object = hashlib.sha256(input_text.encode())
    hex_dig = hash_object.hexdigest()
    
    print(f"Input: {input_text}")
    print(f"SHA-256 Hash: {hex_dig}")
    print(f"Hash Length: {len(hex_dig)} characters")
    
# Test with different inputs
demonstrate_hash_properties("Hello World")
demonstrate_hash_properties("Hello World!")  # One character difference
demonstrate_hash_properties("A very long input string that demonstrates the fixed output length property of cryptographic hash functions regardless of input size")
                                    </pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Task 2 -->
                    <div class="task-section">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h3 class="mb-0">Task 2: Comparing Hash Algorithms</h3>
                            </div>
                            <div class="card-body">
                                <p>Implement and compare different hash algorithms to understand their characteristics.</p>
                                <ol>
                                    <li>Create a script that generates hashes using MD5, SHA-1, SHA-256, and SHA-3</li>
                                    <li>Compare execution speed on large files (>100MB)</li>
                                    <li>Research and document the security strengths and weaknesses of each algorithm</li>
                                    <li>Demonstrate a collision for MD5 (if possible) or research known collisions</li>
                                </ol>
                                <div class="alert alert-secondary">
                                    <strong>Hash Algorithm Comparison Code:</strong>
                                    <pre>
import hashlib
import time

def compare_hash_algorithms(data):
    # Measure time for MD5
    start = time.time()
    md5_hash = hashlib.md5(data).hexdigest()
    md5_time = time.time() - start
    
    # Measure time for SHA-1
    start = time.time()
    sha1_hash = hashlib.sha1(data).hexdigest()
    sha1_time = time.time() - start
    
    # Measure time for SHA-256
    start = time.time()
    sha256_hash = hashlib.sha256(data).hexdigest()
    sha256_time = time.time() - start
    
    # Measure time for SHA-3
    start = time.time()
    sha3_hash = hashlib.sha3_256(data).hexdigest()
    sha3_time = time.time() - start
    
    print(f"MD5: {md5_hash} (Time: {md5_time:.6f}s)")
    print(f"SHA-1: {sha1_hash} (Time: {sha1_time:.6f}s)")
    print(f"SHA-256: {sha256_hash} (Time: {sha256_time:.6f}s)")
    print(f"SHA-3: {sha3_hash} (Time: {sha3_time:.6f}s)")

# Generate a large dataset for testing
large_data = b"x" * 1000000  # 1MB of data
compare_hash_algorithms(large_data)
                                    </pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Task 3 -->
                    <div class="task-section">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h3 class="mb-0">Task 3: Data Integrity with Hashing</h3>
                            </div>
                            <div class="card-body">
                                <p>Implement a file integrity verification system using hash functions.</p>
                                <ol>
                                    <li>Create a script that generates hash values for files in a directory</li>
                                    <li>Store these hash values in a database or manifest file</li>
                                    <li>Write a verification script that checks if files have been modified</li>
                                    <li>Test the system by deliberately modifying files and observing detection</li>
                                </ol>
                                <div class="alert alert-secondary">
                                    <strong>File Integrity Checker Example:</strong>
                                    <pre>
import hashlib
import os
import json

def calculate_file_hash(filepath):
    """Calculate SHA-256 hash of a file"""
    sha256_hash = hashlib.sha256()
    with open(filepath, "rb") as f:
        for byte_block in iter(lambda: f.read(4096), b""):
            sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()

def generate_manifest(directory):
    """Generate hash manifest for all files in directory"""
    manifest = {}
    for root, _, files in os.walk(directory):
        for filename in files:
            filepath = os.path.join(root, filename)
            manifest[filepath] = calculate_file_hash(filepath)
    
    with open("hash_manifest.json", "w") as f:
        json.dump(manifest, f, indent=4)
    
    print(f"Generated manifest for {len(manifest)} files")

def verify_integrity(manifest_path="hash_manifest.json"):
    """Verify file integrity against stored hashes"""
    with open(manifest_path, "r") as f:
        manifest = json.load(f)
    
    modified_files = []
    missing_files = []
    
    for filepath, stored_hash in manifest.items():
        if not os.path.exists(filepath):
            missing_files.append(filepath)
            continue
            
        current_hash = calculate_file_hash(filepath)
        if current_hash != stored_hash:
            modified_files.append(filepath)
    
    return modified_files, missing_files

# Usage
generate_manifest("./target_directory")
modified, missing = verify_integrity()
print(f"Modified files: {modified}")
print(f"Missing files: {missing}")
                                    <pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Task 4 -->
                    <div class="task-section">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h3 class="mb-0">Task 4: Secure Password Storage with Salted Hashes</h3>
                            </div>
                            <div class="card-body">
                                <p>Implement secure password storage techniques using salted hash functions.</p>
                                <ol>
                                    <li>Create a user registration system that stores salted password hashes</li>
                                    <li>Implement a login verification system that validates passwords against stored hashes</li>
                                    <li>Compare plain hashing with salted hashing for security</li>
                                    <li>Implement and test different work factors for adaptive hashing algorithms</li>
                                </ol>
                                <div class="alert alert-secondary">
                                    <strong>Secure Password Storage Example:</strong>
                                    <pre>
import hashlib
import os
import base64

class PasswordManager:
    def __init__(self, salt_length=16):
        self.salt_length = salt_length
        self.user_db = {}  # In a real system, this would be a database
    
    def generate_salt(self):
        """Generate a random salt"""
        return os.urandom(self.salt_length)
    
    def hash_password(self, password, salt=None):
        """Hash a password with a salt using PBKDF2"""
        if salt is None:
            salt = self.generate_salt()
        
        # Use PBKDF2 with 100,000 iterations (adjust based on security needs)
        key = hashlib.pbkdf2_hmac(
            'sha256',
            password.encode('utf-8'),
            salt,
            iterations=100000
        )
        
        # Store salt and key together
        storage = salt + key
        return base64.b64encode(storage).decode('utf-8')
    
    def verify_password(self, stored_hash, provided_password):
        """Verify if provided password matches stored hash"""
        # Decode the stored hash
        storage = base64.b64decode(stored_hash.encode('utf-8'))
        
        # Extract salt (first salt_length bytes)
        salt = storage[:self.salt_length]
        
        # Hash the provided password with the extracted salt
        new_hash = self.hash_password(provided_password, salt)
        
        # Compare hashes
        return stored_hash == new_hash
    
    def register_user(self, username, password):
        """Register a new user"""
        if username in self.user_db:
            return False, "User already exists"
        
        hashed_password = self.hash_password(password)
        self.user_db[username] = hashed_password
        return True, "User registered successfully"
    
    def authenticate_user(self, username, password):
        """Authenticate a user"""
        if username not in self.user_db:
            return False, "User not found"
        
        stored_hash = self.user_db[username]
        if self.verify_password(stored_hash, password):
            return True, "Authentication successful"
        else:
            return False, "Incorrect password"

# Usage example
pm = PasswordManager()
pm.register_user("alice", "secure_password123")
result, message = pm.authenticate_user("alice", "secure_password123")
print(message)  # Authentication successful
                                    </pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Conclusion -->
                <section class="mt-4 mb-5">
                    <div class="card">
                        <div class="card-header bg-secondary text-white">
                            <h2 class="mb-0">Conclusion</h2>
                        </div>
                        <div class="card-body">
                            <p>This lab provided practical experience with cryptographic hash functions, their properties, and applications. You've learned how to implement and compare different hash algorithms, use hashing for data integrity verification, and apply secure password storage techniques with salted hashes.</p>
                            <p>When implementing security systems in practice, remember that hash functions are just one component of a comprehensive security strategy. Modern systems often require layered security approaches, including encryption, access controls, and ongoing security updates.</p>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Sidebar -->
            <div class="col-md-4">
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h4 class="mb-0">Resources</h4>
                    </div>
                    <div class="card-body">
                        <h5>Tools Required</h5>
                        <ul class="list-group mb-3">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                Python 3
                                <a href="#" class="btn btn-sm btn-outline-primary">Download</a>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                HashCalc
                                <a href="#" class="btn btn-sm btn-outline-primary">Download</a>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                OpenSSL
                                <a href="#" class="btn btn-sm btn-outline-primary">Download</a>
                            </li>
                        </ul>
                        
                        <h5>Helpful Links</h5>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action">NIST Hash Function Standards</a>
                            <a href="#" class="list-group-item list-group-item-action">OWASP Password Storage Guidelines</a>
                            <a href="#" class="list-group-item list-group-item-action">Hash Function Security Comparison</a>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h4 class="mb-0">Related Labs</h4>
                    </div>
                    <div class="card-body">
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-action">Lab 2.1: Cryptography Fundamentals: Brute Force</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-5 pt-3 border-top">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <h4 style="font-weight: bold;">Contact</h4>
                        <p>Email: contact@securitylabs.com</p>
                        <p>Twitter: @securitylabs</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p>&copy; 2025 Sypher Security Labs</p>
                        <p><a href="#">Privacy Policy</a> | <a href="#">Terms of Use</a> | <a href="#">Home</a></p>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>